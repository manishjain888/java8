<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
  <!-- ************************************* Parsers for Nucleus published messages *******************************************-->
  <bean id="AutoFundingAckProcessor" class="com.rbs.rbsgbl.loaniq.funding.process.messageprocessor.AutoFundingAckProcessor">
   <property name="messagePersistenceHandler"><ref bean="AutoFundMessageBS"/></property> 
  </bean>
  
  <bean id="ArgonReceiveHandler_Target" class="com.rbs.rbsgbl.loaniq.funding.process.messagereceiver.ArgonReceiveHandler">
    <constructor-arg index="0">
      <map><entry key="wssmmtrdrsp"><value>ln:dev:wss:rbs_loaniq_ln , ln:dev:wss:nw_loaniq_ln</value></entry></map>
    </constructor-arg>
    <property name="messageProcessor"><ref bean="AutoFundingAckProcessor"/></property>
    <property name="suspendPeriod"><value>0</value></property>
    <property name="timeoutPeriod"><value>-1</value></property><!--In miliseconds, -1 will indicate it will wait indefinitely for the message to come-->    
    <property name="pollRetries"><value>-1</value></property><!--Number of times to retry to look for messages, -1 indicates not dependent on retrial and will never be terminated-->    
     <property name="argonReceiverType"><value>SINGLE</value></property>
     	<property name="windowsServiceVO"><ref bean="WindowsServiceVO"/></property> 
  </bean>
      
  <bean id="ArgonReceiveHandler" class="org.springframework.aop.framework.ProxyFactoryBean">
		<property name="target">
			<ref bean="ArgonReceiveHandler_Target"/>
		</property>
		<property name="proxyInterfaces">
	    	<value>com.rbs.rbsgbl.loaniq.generic.messagereceiver.handlers.ReceiveHandler</value>
	 	</property>
  </bean>
	
  <bean id="FundingArgonClientHandler" class="com.rbs.rbsgbl.loaniq.generic.messagereceiver.handlers.ArgonClientHandler">
    <constructor-arg index="0">
      <list>        
         <ref bean="ArgonReceiveHandler"/>
      </list>
    </constructor-arg>
    <property name="argonClient"><bean class="com.rbsfm.argon.client.cga.Client"/></property>
    <property name="clientNodeAddress">
      <bean class="com.rbsfm.argon.client.cga.ClientNodeAddress">
        <constructor-arg index="0"><value>ln:dev:loaniq:funding_ack</value></constructor-arg>    
      </bean>
    </property>   
  </bean>    
  
<!-- Message Receiver configuration -->	  
  <bean id="argonMessageReceiver" class="com.rbs.rbsgbl.loaniq.funding.process.messagereceiver.ArgonMessageReceiver">
    <property name="persistenceHandler"><ref bean="AutoFundMessageBS"/></property>
    <property name="handlers">
       <list>
         <ref bean="FundingArgonClientHandler"/> <!-- Client handler for Funding messages -->
      		 <!-- You may introduce new Client handlers here in future-->  
       </list>
    </property>
  </bean>
  
  	<bean id="oracleDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="shutdown">
		<property name="driverClassName" value="${jdbc.oradriverClassName}" />
		<property name="url" value="${jdbc.oraurl}" />
		<property name="username" value="${jdbc.orausername}" />
		<!--<property name="password" value="${jdbc.orapassword}" />-->
		<property name="password">
			<bean id="passwordDecryptor.strPassword" class="org.springframework.beans.factory.config.PropertyPathFactoryBean"/>
		</property>
	</bean>	
	    
  <bean id="MessageReceiver"  class="com.rbs.rbsgbl.loaniq.funding.process.messagereceiver.AutoFundArgonMsgReceiver" init-method="processFlow" destroy-method="doFinalize">
	<property name="messagereceiver"><ref bean="argonMessageReceiver"/></property> 
	<!--property name="windowsServiceVO"><ref bean="WindowsServiceVO"/></property--> 
  </bean>  
  
   <bean id="WindowsServiceVO"  class="com.rbs.rbsgbl.loaniq.funding.process.messagereceiver.WindowsServiceVO">
   </bean> 
   
   	<bean id="AutoFundMessageBS" class="org.springframework.aop.framework.ProxyFactoryBean">
		<property name="target">
			<ref bean="AutoFundMessageBSImpl"/>
		</property>
		<property name="proxyInterfaces">
	    	<value>com.rbs.rbsgbl.loaniq.funding.datastore.AutoFundMessageBS</value>
	 	</property>
	</bean>
			
	<bean id="AutoFundMessageBSImpl" class="com.rbs.rbsgbl.loaniq.funding.datastore.AutoFundMessageBSImpl">
		<property name="autoFundingMessageDAO">
			<ref bean="AutoFundingMessageDAO"/>
		</property>
		<property name="autoFundMessage">
			<ref bean="AutoFundMessage"/>
		</property>
	</bean>
	
	<bean id="AutoFundMessage" class="com.rbs.rbsgbl.loaniq.funding.process.AutoFundMessage">
		<property name="strXSDFileName" value="${e_autoFundingArgonMessageXSD}" />
		<property name="validateXML">
			<ref bean="ValidateXML"/>
		</property>	
	</bean>
	

	<bean id="ValidateXML" class="com.rbs.rbsgbl.loaniq.generic.common.ValidateXML">		
	</bean>
	
	<!--@TODO to make different bean for the implementation class-->
	<bean id="AutoFundingMessageDAO" class="com.rbs.rbsgbl.loaniq.funding.datastore.AutoFundingMessageDAOImpl">
		<property name="sqlMapClient" ref="sqlMapClient"/>
		<property name="dataSource" ref="oracleDataSource"/>	
	</bean>	
 
</beans>